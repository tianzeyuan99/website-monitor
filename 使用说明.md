# 中国海油网站404链接监测工具 - 使用说明

## 快速开始

### 方法1：直接运行（需要Python环境）

1. **安装依赖**
   ```bash
   pip install -r requirements.txt
   python -m playwright install chromium
   ```

2. **运行程序**
   ```bash
   python website_monitor_app.py
   ```

3. **访问界面**
   - 程序会自动打开浏览器
   - 如果没有自动打开，手动访问：http://127.0.0.1:5000

### 方法2：打包成exe（推荐，无需Python环境）

1. **打包程序**
   - Windows: 双击运行 `build_windows.bat`
   - 或手动执行打包命令（见下方）

2. **获取可执行文件**
   - 打包完成后，在 `dist` 目录找到 `网站监测工具.exe`
   - 将这个exe文件复制给用户即可

3. **运行exe**
   - 双击 `网站监测工具.exe`
   - 程序会自动打开浏览器显示界面

## 功能说明

### Web界面功能

1. **开始监测** - 点击按钮开始监测所有网站
2. **实时进度** - 显示当前监测进度和状态
3. **404链接展示** - 自动显示所有404链接及其来源
4. **刷新数据** - 手动刷新404链接列表

### 界面特点

- ✅ 现代化UI设计
- ✅ 实时进度显示
- ✅ 404链接清晰展示
- ✅ 每个404链接下方显示来源页面
- ✅ 统计信息（404链接总数、来源网站数）

## 打包说明

### Windows打包步骤

1. **安装Python 3.8+**
   - 从 https://www.python.org/downloads/ 下载
   - 安装时勾选 "Add Python to PATH"

2. **运行打包脚本**
   ```cmd
   build_windows.bat
   ```

3. **手动打包（如果脚本失败）**
   ```cmd
   pip install pyinstaller
   pyinstaller --onefile --name "网站监测工具" --add-data "templates;templates" --hidden-import=flask --hidden-import=playwright --hidden-import=requests --hidden-import=parse_websites_elements --console website_monitor_app.py
   ```

### 打包后的文件

- `dist/网站监测工具.exe` - 可执行文件
- 将exe文件复制给用户即可，无需其他文件

## 注意事项

1. **首次运行**：程序首次运行时，Playwright可能需要下载浏览器，请确保网络连接正常

2. **浏览器检测**：程序会自动检测并使用以下浏览器（按优先级）：
   - Microsoft Edge
   - 中国海油企业安全浏览器
   - Chromium（Playwright自带）

3. **端口占用**：如果5000端口被占用，程序会报错，请关闭占用该端口的程序

4. **文件输出**：监测结果会保存为JSON文件（`404_links_*.json`），保存在exe文件同目录

## 故障排除

### 问题1：双击exe没有反应
- 检查是否有杀毒软件拦截
- 尝试右键"以管理员身份运行"
- 查看是否有错误提示窗口

### 问题2：浏览器无法打开
- 手动访问 http://127.0.0.1:5000
- 检查防火墙是否阻止了程序

### 问题3：监测失败
- 检查网络连接
- 确认浏览器已正确安装
- 查看命令行窗口的错误信息

### 问题4：打包失败
- 确保已安装所有依赖：`pip install -r requirements.txt`
- 确保已安装PyInstaller：`pip install pyinstaller`
- 检查templates目录是否存在

## 技术栈

- **后端**: Python 3.8+ + Flask
- **前端**: HTML5 + CSS3 + JavaScript
- **浏览器自动化**: Playwright
- **打包工具**: PyInstaller

